@page "/termine"
@using System.Globalization
@using Entities
@inject IJSRuntime JS
@inject AppDbContext DbContext

<PageTitle>Termine:</PageTitle>
<Div Width="Width.Is100.OnDesktop.Is100.OnMobile">
    <Table Striped Narrow="true" Responsive="true">
        <TableHeader>
            <TableRow>
                <TableHeaderCell>Veranstaltung</TableHeaderCell>
                <TableHeaderCell>Datum</TableHeaderCell>
                <TableHeaderCell >Anmerkung</TableHeaderCell>
            </TableRow>
        </TableHeader>
        <TableBody>
            @foreach (var termin in TerminList)
            {
                <TableRow>
                    <TableRowCell>@termin.Name</TableRowCell>
                <TableRowCell>@termin.DateTime.ToString("dd.MM.yyyy HH:mm")</TableRowCell>
                <TableRowCell>@termin.Annotation</TableRowCell>
            </TableRow>
            }      
        </TableBody>
    </Table>
</Div>

@code {
    private List<Termin>? TerminList { get; set; }

    protected override void OnInitialized()
    {
        TerminList = DbContext.Termins.Where(t => t.DateTime > DateTime.Now)
        .OrderBy(t => t.DateTime)
        .AsParallel()
        .ToList();
    }
}
